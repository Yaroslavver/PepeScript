<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimpleScript ‚Äî —Å–≤–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</title>
    <style>
        /* –¢–Å–ú–ù–´–ô –î–ò–ó–ê–ô–ù –ö–ê–ö –í VS CODE (–ü–û–õ–ù–û–°–¢–¨–Æ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù) */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            background: linear-gradient(145deg, #0B1926 0%, #1A2C3D 100%);
            padding: 24px;
            min-height: 100vh;
            color: #E6F1FF;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∏ –≤—ã–≤–æ–¥–∞ */
        .editor-card, .output-card {
            background: #1E2A3A;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            border: 1px solid #2D3F4F;
            backdrop-filter: blur(10px);
        }

        h2 {
            color: #9FD9F2;
            margin-bottom: 20px;
            font-size: 20px;
            font-weight: 600;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        h2::before {
            content: '‚ñ∂';
            color: #6BBF59;
            font-size: 16px;
        }

        /* –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞ */
        #code-editor {
            width: 100%;
            height: 450px;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 15px;
            line-height: 1.6;
            padding: 20px;
            background: #0F1A24;
            color: #E6F1FF;
            border: 2px solid #2D4A5C;
            border-radius: 12px;
            resize: vertical;
            outline: none;
            transition: all 0.3s;
            box-shadow: inset 0 4px 8px rgba(0,0,0,0.2);
        }

        #code-editor:focus {
            border-color: #6BBF59;
            box-shadow: inset 0 4px 12px rgba(107,191,89,0.1);
        }

        #code-editor::placeholder {
            color: #5A7387;
        }

        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .controls {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            font-size: 15px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'JetBrains Mono', monospace;
            display: flex;
            align-items: center;
            gap: 8px;
            letter-spacing: 0.5px;
        }

        .btn-run {
            background: #6BBF59;
            color: #0F1A24;
            flex: 2;
        }

        .btn-clear {
            background: #E66A5C;
            color: white;
            flex: 1;
        }

        .btn-example {
            background: #F7D44A;
            color: #0F1A24;
            flex: 1;
        }

        .btn-toggle {
            background: #2D4A5C;
            color: white;
            width: 100%;
            justify-content: center;
            margin-top: 16px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            filter: brightness(1.1);
        }

        /* –û–±–ª–∞—Å—Ç—å –≤—ã–≤–æ–¥–∞ */
        .output-container {
            background: #0F1A24;
            border-radius: 12px;
            padding: 20px;
            min-height: 450px;
            max-height: 450px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            border: 2px solid #2D4A5C;
            box-shadow: inset 0 4px 8px rgba(0,0,0,0.2);
        }

        .output-line {
            padding: 8px 12px;
            margin: 4px 0;
            border-radius: 6px;
            background: rgba(255,255,255,0.03);
            border-left: 3px solid #4F9FDA;
            animation: fadeIn 0.3s;
        }

        .output-line.success {
            border-left-color: #6BBF59;
            color: #B8E6A8;
        }

        .output-line.error {
            border-left-color: #E66A5C;
            background: rgba(230,106,92,0.1);
            color: #FFB3AA;
        }

        .output-line.warning {
            border-left-color: #F7D44A;
            color: #FFE48F;
        }

        /* –¢—Ä–∞–Ω—Å–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ */
        .transpiled-section {
            margin-top: 20px;
            border-top: 2px solid #2D4A5C;
            padding-top: 20px;
        }

        .transpiled-section pre {
            background: #0F1A24;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 13px;
            color: #B4D9E6;
            border: 1px solid #2D4A5C;
            margin-top: 12px;
        }

        .hidden {
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ —Å–Ω–∏–∑—É */
        .hint {
            margin-top: 20px;
            color: #8AA5B9;
            font-size: 13px;
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .hint span {
            background: #2D4A5C;
            padding: 4px 10px;
            border-radius: 20px;
            color: #E6F1FF;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ */
    .hl-keyword { color: #569CD6; font-weight: bold; }
    .hl-string { color: #CE9178; }
    .hl-number { color: #B5CEA8; }
    .hl-comment { color: #6A9955; }
    .hl-bracket { color: #FFD700; }
    </style>
</head>
<body>
    <div class="container">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: —Ä–µ–¥–∞–∫—Ç–æ—Ä -->
        <div class="editor-card">
            <h2>üìù –†–µ–¥–∞–∫—Ç–æ—Ä PepeScript</h2>
            <div style="position: relative; width: 100%; height: 450px;">
    
    <!-- –≠–õ–ï–ú–ï–ù–¢ 0: —Ñ–æ–Ω -->
    <div id="bg-layer" style="
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        padding: 20px;
        font-family: 'JetBrains Mono', monospace;
        font-size: 15px;
        line-height: 1.6;
        background: #0F1A24;
        color: #E6F1FF;
        border: 2px solid #2D4A5C;
        border-radius: 12px;
        white-space: pre-wrap;
        word-wrap: break-word;
        overflow-y: auto;
        pointer-events: none;  /* –ù–ï–õ–¨–ó–Ø –ö–õ–ò–ö–ê–¢–¨ - –≤—Å—ë –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤–Ω–∏–∑ */
        z-index: 2;
            background: url(https://avatars.mds.yandex.net/i?id=940b4a240538b1d30d75bd77c5c6f06d09228a31-4566264-images-thumbs&n=13);
    background-repeat: repeat;
    opacity:40%;
    filter: contrast(1.5);
    "></div>
    <!-- –≠–õ–ï–ú–ï–ù–¢ 1: –ü–æ–¥—Å–≤–µ—Ç–∫–∞ (DIV) - –≤–∏–¥–∏–º—ã–π, –Ω–æ –Ω–µ—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π -->
    <div id="highlight-layer" style="
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        padding: 20px;
        font-family: 'JetBrains Mono', monospace;
        font-size: 15px;
        line-height: 1.6;
        
        color: #E6F1FF;
        border: 2px solid #2D4A5C;
        border-radius: 12px;
        white-space: pre-wrap;
        word-wrap: break-word;
        overflow-y: auto;
        pointer-events: none;  /* –ù–ï–õ–¨–ó–Ø –ö–õ–ò–ö–ê–¢–¨ - –≤—Å—ë –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤–Ω–∏–∑ */
        z-index: 2;
        font-weight: bold;
            
    "></div>
           <!-- –≠–õ–ï–ú–ï–ù–¢ 2: –†–µ–¥–∞–∫—Ç–æ—Ä (TEXTAREA) - –Ω–µ–≤–∏–¥–∏–º—ã–π, –Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π -->
    <textarea id="code-editor" style="
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        padding: 20px;
        font-family: 'JetBrains Mono', monospace;
        font-size: 15px;
        line-height: 1.6;
        background: transparent;  /* –ü–†–û–ó–†–ê–ß–ù–´–ô - –≤–∏–¥–Ω–æ –ø–æ–¥—Å–≤–µ—Ç–∫—É */
        color: transparent;       /* –¢–ï–ö–°–¢ –ù–ï–í–ò–î–ò–ú–´–ô - –≤–∏–¥–Ω–æ –ø–æ–¥—Å–≤–µ—Ç–∫—É */
        caret-color: white;      /* –ö–£–†–°–û–† –ë–ï–õ–´–ô - –≤–∏–¥–Ω–æ */
        border: 2px solid #2D4A5C;
        border-radius: 12px;
        resize: vertical;
        outline: none;
        z-index: 3;
        font-weight: bold;
    "></textarea></div>
            
            <div class="controls">
                <button class="btn btn-run" onclick="window.simpleScript.run()">
                    <span>‚ñ∂</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å
                </button>
                <button class="btn btn-clear" onclick="window.simpleScript.clearOutput()">
                    <span>üóë</span> –û—á–∏—Å—Ç–∏—Ç—å
                </button>
                <button class="btn btn-example" onclick="window.simpleScript.loadExample()">
                    <span>üìã</span> –ü—Ä–∏–º–µ—Ä
                </button>
            </div>
            
            <button class="btn btn-toggle" onclick="window.simpleScript.toggleTranspiled()">
                <span>üîß</span> –ü–æ–∫–∞–∑–∞—Ç—å JavaScript –∫–æ–¥
            </button>
            
            <div id="transpiled" class="transpiled-section hidden">
                <h3 style="color: #9FD9F2; margin-bottom: 8px;">‚ö° –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript:</h3>
                <pre id="transpiled-code-content"></pre>
            </div>
            
            <div class="hint">
                <span>–∫–≤–∞–∫–∞—Ç—å() üìå –≤—ã–≤–µ—Å—Ç–∏</span>
                <span>üìå –ø–µ–ø–µ x = 5</span>
                <span>üìå –ø–µ–ø–µ x</span>
                <span>–∞—â–µ() { } üìå –µ—Å–ª–∏</span>
                <span>–∏–Ω–∞–∫–æ() { }üìå –∏–Ω–∞—á–µ</span>
                <span>–ø–æ–≤—Ç–æ—Ä–∏—Ç—å(n) { } üìå –ø–æ–≤—Ç–æ—Ä–∏—Ç—å n —Ä–∞–∑</span>
                <span>–¥–æ–Ω–¥–µ–∂–µ() { } üìå –ø–æ–∫–∞</span>
                <span>—Å—É—Ç—å üìå = (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ)</span>
                <span>–Ω–µ —Å—É—Ç—å üìå –Ω–µ= (!==)</span>
                <span>—É–∫–∞–∑ üìå —Ñ—É–Ω–∫—Ü–∏—è</span>
                <span>–∂—Ä–µ–±–∏–π() üìå —Å–ª—É—á–∞–π–Ω–æ–µ</span>
            </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –≤—ã–≤–æ–¥ -->
        <div class="output-card">
            <h2>üìü –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h2>
            <div id="output" class="output-container">
                <div class="output-line success">‚úì –ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</div>
            </div>
        </div>
    </div>

    <script>
        // ================== –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –¢–†–ê–ù–°–ü–ê–ô–õ–ï–† ==================
        class SimpleScriptTranspiler {
            constructor() {
                // –°–ª–æ–≤–∞—Ä—å –¢–û–õ–¨–ö–û –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ (–±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤!)
                this.keywords = new Map([
                    ['–∫–≤–∞–∫–∞—Ç—å', 'console.log'],
                    ['–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞', 'const'],
                    ['—É–∫–∞–∑', 'function'],
                    ['–≤–µ—Ä–Ω—É—Ç—å', 'return'],
                    ['–∏—Å—Ç–∏–Ω–∞', 'true'],
                    ['–ª–æ–∂—å', 'false'],
                    ['–Ω–∏—á—Ç–æ', 'null'],
                    ['–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ', 'undefined'],
                    ['–Ω–µ —Å—É—Ç—å', '!='],
                    ['—Å—É—Ç—å', '='],                    
                    // –ú–µ—Ç–æ–¥—ã –º–∞—Å—Å–∏–≤–æ–≤
                    ['–¥–ª–∏–Ω–∞', 'length'],
                    ['–¥–æ–±–∞–≤–∏—Ç—å', 'push'],
                    ['—É–¥–∞–ª–∏—Ç—å', 'pop'],
                    ['–ø–µ—Ä–≤—ã–π', 'shift'],
                    ['–ø–æ—Å–ª–µ–¥–Ω–∏–π', 'pop'],
                    // –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞
                    ['–æ–∫—Ä—É–≥–ª–∏—Ç—å', 'Math.round'],
                    ['–∂—Ä–µ–±–∏–π', 'Math.random'],
                    ['—Ü–µ–ª–æ–µ', 'parseInt'],
                    ['–¥—Ä–æ–±–Ω–æ–µ', 'parseFloat']
                ]);

                // –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å –ü–†–ê–í–ò–õ–¨–ù–´–ú–ò —Å–∫–æ–±–∫–∞–º–∏ –∏ –∑–∞—â–∏—Ç–æ–π –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
                this.patterns = [
                    // 1. –ø–µ—á–∞—Ç—å("—Ç–µ–∫—Å—Ç") ‚Üí console.log("—Ç–µ–∫—Å—Ç")
                    {
                        regex: /–∫–≤–∞–∫–∞—Ç—å\s*\(([^)]*)\)/g,
                        replace: 'console.log($1)'
                    },
                    // 2. –ø–æ–≤—Ç–æ—Ä–∏—Ç—å(N) { ... } ‚Üí for(let i=0; i<N; i++) { ... }
                    {
                        regex: /–ø–æ–≤—Ç–æ—Ä–∏—Ç—å\s*\((\d+)\)\s*{([^}]*)}/g,
                        replace: (match, count, body) => 
                            `for(let i = 0; i < ${count}; i++) { ${body} }`
                    },
                    // 3. –ø–æ–∫–∞(—É—Å–ª–æ–≤–∏–µ) { ... } ‚Üí while(—É—Å–ª–æ–≤–∏–µ) { ... }
                    {
                        regex: /–¥–æ–Ω–¥–µ–∂–µ\s*\(([^)]+)\)\s*{([^}]*)}/g,
                        replace: (match, condition, body) => {
                            let fixedCondition = this.replaceComparisons(condition);
                            return `while(${fixedCondition}) { ${body} }`;
                        }
                    },
                    // 4. –µ—Å–ª–∏(—É—Å–ª–æ–≤–∏–µ) { ... } ‚Üí if(—É—Å–ª–æ–≤–∏–µ) { ... }
                    {
                        regex: /–∞—â–µ\s*\(([^)]+)\)\s*{([^}]*)}/g,
                        replace: (match, condition, body) => {
                            let fixedCondition = this.replaceComparisons(condition);
                            return `if(${fixedCondition}) { ${body} }`;
                        }
                    },
                    // 5. –∏–Ω–∞—á–µ { ... } ‚Üí else { ... }
                    {
                        regex: /–∏–Ω–∞–∫–æ\s*{([^}]*)}/g,
                        replace: 'else { $1 }'
                    },
                    // 6. —Ñ—É–Ω–∫—Ü–∏—è –∏–º—è(–ø–∞—Ä–∞–º–µ—Ç—Ä—ã) { ... } ‚Üí function –∏–º—è(–ø–∞—Ä–∞–º–µ—Ç—Ä—ã) { ... }
                    {
                        regex: /—É–∫–∞–∑\s+(\w+)\s*\(([^)]*)\)\s*{([^}]*)}/g,
                        replace: 'function $1($2) { $3 }'
                    }
                ];
            }

            // –ó–∞–º–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¢–û–õ–¨–ö–û –≤–Ω—É—Ç—Ä–∏ —É—Å–ª–æ–≤–∏–π
            replaceComparisons(expr) {
                return expr
                    .replace(/–Ω–µ=/g, '!==')   // —Å–Ω–∞—á–∞–ª–∞ –¥–ª–∏–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä
                    .replace(/=/g, '==')
                    .replace(/<==/g, '<=')
                    .replace(/>==/g, '>=');    // –∑–∞—Ç–µ–º –ø—Ä–æ—Å—Ç–æ–π "="
            }

            // –ó–∞–º–µ–Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∏ –±–µ–∑ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
            replaceVariableDeclaration(line) {
                // –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è x = 5   ‚Üí   let x = 5
                // –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è x       ‚Üí   let x
                const varRegex = /–ø–µ–ø–µ\s+([a-zA-Z–∞-—è–ê-–Ø—ë–Å_][a-zA-Z–∞-—è–ê-–Ø—ë–Å0-9_]*)(?:\s*=\s*(.*?))?(?:\s*;)?$/;
                return line.replace(varRegex, (match, name, value) => {
                    if (value !== undefined) {
                        return `let ${name} = ${value}`;
                    } else {
                        return `let ${name}`;
                    }
                });
            }

            // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
            replaceKeywords(text) {
                let result = text;
                for (let [rus, js] of this.keywords) {
                    // –°–≤–æ–∏ –≥—Ä–∞–Ω–∏—Ü—ã —Å–ª–æ–≤–∞ –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã: –ø–µ—Ä–µ–¥ —Å–ª–æ–≤–æ–º ‚Äî –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ –Ω–µ –±—É–∫–≤–∞/—Ü–∏—Ñ—Ä–∞/_
                    // –ø–æ—Å–ª–µ —Å–ª–æ–≤–∞ ‚Äî –∫–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ –Ω–µ –±—É–∫–≤–∞/—Ü–∏—Ñ—Ä–∞/_
                    const regex = new RegExp(
                        `(^|[^a-zA-Z–∞-—è–ê-–Ø—ë–Å0-9_])${rus}(?=[^a-zA-Z–∞-—è–ê-–Ø—ë–Å0-9_]|$)`,
                        'g'
                    );
                    result = result.replace(regex, `$1${js}`);
                }
                return result;
            }

            // –ì–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ —Ç—Ä–∞–Ω—Å–ø–∏–ª—è—Ü–∏–∏
            transpile(code) {
                if (!code || code.trim() === '') return '';

                let output = code;

                // 1. –°–Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (–µ—Å–ª–∏, –ø–æ–∫–∞, –ø–æ–≤—Ç–æ—Ä–∏—Ç—å...)
                for (let pattern of this.patterns) {
                    output = output.replace(pattern.regex, pattern.replace);
                }

                // 2. –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
                const lines = output.split('\n');
                const processedLines = [];

                for (let line of lines) {
                    let processed = line;

                    // 3. –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ "–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è"
                    if (processed.includes('–ø–µ–ø–µ')) {
                        processed = this.replaceVariableDeclaration(processed);
                    }

                    // 4. –ó–∞–º–µ–Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ (—Å –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏)
                    processed = this.replaceKeywords(processed);

                    processedLines.push(processed);
                }

                output = processedLines.join('\n');

                // 5. –§–∏–Ω–∞–ª—å–Ω–∞—è —á–∏—Å—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
                output = this.fixSyntax(output);
                return output;
            }

            // –ß–∏—Å—Ç–∫–∞ –ª–∏—à–Ω–∏—Ö —Ç–æ—á–µ–∫ —Å –∑–∞–ø—è—Ç–æ–π –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            fixSyntax(code) {
                let fixed = code;
                // –£–±–∏—Ä–∞–µ–º –¥–≤–æ–π–Ω—ã–µ ;;
                fixed = fixed.replace(/;;/g, ';');
                // –î–æ–±–∞–≤–ª—è–µ–º ; –≤ –∫–æ–Ω—Ü–∞—Ö —Å—Ç—Ä–æ–∫, –≥–¥–µ –Ω—É–∂–Ω–æ
                fixed = fixed.replace(/([^;{}])\n(?!\s*[{}])/g, '$1;\n');
                fixed = fixed.replace(/([^;])\s*\n\s*\}/g, '$1;\n}');
                return fixed;
            }
        }

        // ================== –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¢–û–† ==================
        class SimpleScriptInterpreter {
            constructor() {
                this.transpiler = new SimpleScriptTranspiler();
            }

            execute(code) {
                try {
                    const jsCode = this.transpiler.transpile(code);
                    const sandbox = this.createSandbox();
                    const func = new Function('sandbox', `
                        with(sandbox) {
                            ${jsCode}
                        }
                        return sandbox._output;
                    `);
                    const result = func(sandbox);
                    return {
                        success: true,
                        output: result || [],
                        jsCode,
                        error: null
                    };
                } catch (error) {
                    return {
                        success: false,
                        output: [],
                        jsCode: this.transpiler.transpile(code),
                        error: error.message
                    };
                }
            }

            createSandbox() {
                const output = [];
                const sandbox = {
                    console: {
                        log: (...args) => {
                            const message = args.map(arg => 
                                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
                            ).join(' ');
                            output.push({ type: 'log', message });
                        }
                    },
                    _output: output,
                    Array, Object, String, Number, Boolean, Math, JSON, Date, RegExp
                };
                return sandbox;
            }
        }

        // ================== UI –ö–û–ù–¢–†–û–õ–õ–ï–† ==================
        class SimpleScriptUI {
            constructor() {
                this.interpreter = new SimpleScriptInterpreter();
                this.editor = document.getElementById('code-editor');
                this.outputContainer = document.getElementById('output');
                this.transpiledContent = document.getElementById('transpiled-code-content');
                this.transpiledSection = document.getElementById('transpiled');
                window.simpleScript = this;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                this.clearOutput();
                this.addOutputLine('‚úì –ì–æ—Ç–æ–≤ –∫ –∫–≤–∞–∫–∞–Ω—å—é', 'success');
            }

            run() {
                const code = this.editor.value;
                const result = this.interpreter.execute(code);
                
                this.transpiledContent.textContent = result.jsCode || '// –ü—É—Å—Ç–æ–π –∫–æ–¥';
                this.clearOutput();

                if (result.success) {
                    if (result.output.length) {
                        result.output.forEach(item => 
                            this.addOutputLine(item.message, 'success')
                        );
                    } else {
                        this.addOutputLine('‚úì –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                    }
                } else {
                    this.addOutputLine(`‚ùå –õ—è–≥—É—à–∫–∞ —Å–ª–æ–º–∞–ª–∞—Å—å: ${result.error}`, 'error');
                    this.addOutputLine('üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, —Å–∫–æ–±–∫–∏ –∏ –∑–∞–ø–∞—Å—ã –ª—è–≥—É—à–µ–∫', 'warning');
                }
            }

            addOutputLine(message, type = 'log') {
                const line = document.createElement('div');
                line.className = `output-line ${type}`;
                let icon = '‚Ä¢';
                if (type === 'success') icon = 'üê∏';//'‚úì';
                if (type === 'error') icon = "‚ùå";//‚úó';
                if (type === 'warning') icon = '‚ö†';
                line.textContent = `${icon} ${message}`;
                this.outputContainer.appendChild(line);
                line.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }

            clearOutput() {
                this.outputContainer.innerHTML = '';
            }

            loadExample() {
                this.editor.value = `–∫–≤–∞–∫–∞—Ç—å("–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!")

–ø–µ–ø–µ –∏–º—è = "–ü–µ–ø–µ"
–∞—â–µ(–∏–º—è —Å—É—Ç—å "–ü–µ–ø–µ") {
  –∫–≤–∞–∫–∞—Ç—å("–ü—Ä–∏–≤–µ—Ç, " + –∏–º—è + "!")
}

// –ü—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ –±–µ–∑ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
–ø–µ–ø–µ x
x = 42
–∫–≤–∞–∫–∞—Ç—å("x = " + x)

// –¶–∏–∫–ª—ã
–ø–æ–≤—Ç–æ—Ä–∏—Ç—å(3) {
  –∫–≤–∞–∫–∞—Ç—å("–†–∞–∑!")
}

–ø–µ–ø–µ i = 1
–¥–æ–Ω–¥–µ–∂–µ(i <= 3) {
  –∫–≤–∞–∫–∞—Ç—å("i = " + i)
  i = i + 1
}`;
                highlightCode();
                this.run();
            }

            toggleTranspiled() {
                this.transpiledSection.classList.toggle('hidden');
            }
            
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            new SimpleScriptUI();
        });



        // ========== –ü–†–û–°–¢–ï–ô–®–ê–Ø –ü–û–î–°–í–ï–¢–ö–ê ==========
    function highlightCode() {
        const textarea = document.getElementById('code-editor');
        const highlight = document.getElementById('highlight-layer');
        
        // –ë–µ—Ä—ë–º –∫–æ–¥ –∏–∑ textarea
        let code = textarea.value;
        
        // –ü–û–î–°–í–ï–ß–ò–í–ê–ï–ú (5 –ø—Ä–∞–≤–∏–ª - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
        let highlighted = code
            // 1. –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (—Å–∏–Ω–∏–µ)
            .replace(/\b(–∫–≤–∞–∫–∞—Ç—å|–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è|–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞|–∞—â–µ|–∏–Ω–∞–∫–æ|–¥–æ–Ω–¥–µ–∂–µ|–ø–æ–≤—Ç–æ—Ä–∏—Ç—å|—É–∫–∞–∑|–≤–µ—Ä–Ω—É—Ç—å|–∏—Å—Ç–∏–Ω–∞|–ª–æ–∂—å|–Ω–∏—á—Ç–æ)\b/g, 
                '<span style="color: #569CD6; font-weight: bold;">$1</span>')
            
            // 2. –°—Ç—Ä–æ–∫–∏ (–æ—Ä–∞–Ω–∂–µ–≤—ã–µ)
            .replace(/"([^"]*)"/g, 
                '<span style="color: #36d1ff;">"$1"</span>')
            
            // 3. –ß–∏—Å–ª–∞ (–∑–µ–ª—ë–Ω—ã–µ)
            .replace(/\b(\d+)\b/g, 
                '<span style="color: #ffc100;">$1</span>')
            
            // 4. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (—Å–µ—Ä–æ-–∑–µ–ª—ë–Ω—ã–µ)
            .replace(/\/\/(.*)/g, 
                '<span style="color: #5ef71a;">//$1</span>')
            
            // 5. –°–∫–æ–±–∫–∏ (–∂—ë–ª—Ç—ã–µ)
            .replace(/([{}()[\]])/g, 
                '<span style="color: #e279ff;">$1</span>');
        
        // –í—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–¥—Å–≤–µ—á–µ–Ω–Ω—ã–π –∫–æ–¥ –≤ DIV
        highlight.innerHTML = highlighted;
    }
    
    // ========== –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ü–û–î–°–í–ï–¢–ö–ê ==========
    document.addEventListener('DOMContentLoaded', function() {
        
        const textarea = document.getElementById('code-editor');
        
        // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        highlightCode();
        
        // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤–≤–æ–¥–µ
        textarea.addEventListener('input', highlightCode);
        textarea.addEventListener('scroll', function() {
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª
            document.getElementById('highlight-layer').scrollTop = this.scrollTop;
        });
    });
    </script>
</body>
</html>
